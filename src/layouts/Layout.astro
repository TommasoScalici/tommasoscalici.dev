---
import { ClientRouter } from "astro:transitions";
import { Header } from "../components/Header";
import { Footer } from "../components/Footer";
import SEOHead from "../components/SEOHead.astro";

import { ui, defaultLang } from "../i18n/ui";

import "@fontsource/inter";
import "@fontsource/jetbrains-mono";
import "../styles/global.css";
import { getImage } from "astro:assets";
import logoImage from "../assets/logo.webp";

// Optimize Logo
const optimizedLogo = await getImage({
    src: logoImage,
    width: 64, // Slightly larger for high DPR
    height: 64,
    format: "webp",
});

interface Props {
    title: string;
    description?: string;
    lang?: string;
}

const {
    title,
    description = "Senior Software Engineer & Prog Metal Musician",
    lang = defaultLang,
} = Astro.props;

const t = ui[lang as keyof typeof ui] || ui[defaultLang];

const navItems = [
    { label: t["nav.home"], href: lang === "en" ? "/" : `/${lang}` },
    { label: t["nav.projects"], href: "#projects" },
    { label: t["nav.music"], href: "#music" },
];
// Dynamic Copyright Year
const currentYear = new Date().getFullYear();
const startYear = 2010; // Career start
const copyrightDate =
    startYear === currentYear
        ? `${startYear}`
        : `${startYear} - ${currentYear}`;
---

<!doctype html>
<html lang={lang} class="scroll-smooth">
    <head>
        <meta charset="UTF-8" />
        <SEOHead title={title} description={description} />
        <ClientRouter />
    </head>
    <body
        class="bg-background text-white font-sans antialiased selection:bg-primary selection:text-black"
    >
        <Header
            client:load
            lang={lang}
            navItems={navItems}
            logoSrc={optimizedLogo.src}
        />

        <main class="pt-20 min-h-screen relative overflow-hidden">
            <div
                class="fixed top-0 left-1/4 w-96 h-96 bg-primary/10 rounded-full blur-[128px] -z-10 pointer-events-none"
            >
            </div>
            <div
                class="fixed bottom-0 right-1/4 w-96 h-96 bg-secondary/10 rounded-full blur-[128px] -z-10 pointer-events-none"
            >
            </div>

            <slot />
        </main>

        <Footer
            client:visible
            lang={lang}
            t={t}
            copyrightDate={copyrightDate}
        />
    </body>
</html>
